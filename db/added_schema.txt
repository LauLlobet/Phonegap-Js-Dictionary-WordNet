
drop table `selected_senses`;
drop table `ans_sense_cases`;
drop table `test`;
drop table `subjects`;
drop table `subject_sets`;
drop view  selected_wordsXsenses;
drop view  selected_words;

CREATE TABLE `selected_senses` (
  `ssenseid`integer NOT NULL DEFAULT '0'
,  `ctime` integer DEFAULT NULL
,  `dtime` integer DEFAULT NULL
,  `correct` integer DEFAULT NULL
,  `incorrect` integer DEFAULT NULL
,  `wordid` integer  NOT NULL DEFAULT '0'
,  `synsetid` integer  DEFAULT NULL
,  `previous_synsetid` integer DEFAULT NULL
,  PRIMARY KEY (`ssenseid`,`wordid`)
);


CREATE TABLE `ans_sense_cases` (
  `sensecaseid`integer NOT NULL DEFAULT '0'
,  `stime` integer DEFAULT NULL
,  `etime` integer DEFAULT NULL
,  `ssenseid` integer  DEFAULT NULL
,  `wordid` integer  NOT NULL DEFAULT '0'
,  `testid` integer  DEFAULT NULL
,  `trap1id` integer  DEFAULT NULL
,  `trap2id` integer  DEFAULT NULLL
,  `anssid` integer  DEFAULT NULL
,  `anstype`  varchar(30) DEFAULT NULL
,  `testid`integer NOT NULL DEFAULT '0'
,  `selected` integer DEFAULT NULL
,  `y_lvl` integer DEFAULT NULL
,  `x_serie` integer DEFAULT NULL
,  PRIMARY KEY (`sensecaseid`)
);

CREATE TABLE `test` (
  `testid`integer NOT NULL DEFAULT '0'
,  `stime` integer DEFAULT NULL
,  `etime` integer DEFAULT NULL
,  PRIMARY KEY (`gridtestid`)
);

CREATE TABLE `subjects` (
  `subject_id` integer NOT NULL DEFAULT '0'
, `name`  varchar(200) DEFAULT NULL
, `domine`  varchar(200) DEFAULT NULL
, `slot` integer DEFAULT NULL
,  PRIMARY KEY (`subject_id`)
);


CREATE TABLE `subject_sets` (
  `subject_id` integer NOT NULL DEFAULT '0'
, `ssenseid ` integer NOT NULL DEFAULT '0'
,  PRIMARY KEY (`subject_id`,`ssenseid `)
);


CREATE VIEW selected_words AS SELECT lemma, ctime,dtime,wordid,synsetid FROM selected_senses LEFT JOIN words s USING (wordid) 
WHERE dtime IS NULL   GROUP BY lemma ORDER BY ctime DESC;


CREATE VIEW selected_wordsXsenses AS SELECT lemma, ctime,dtime,wordid,synsetid,definition FROM selected_senses LEFT JOIN words s USING (wordid) LEFT JOIN synsets USING (synsetid)
WHERE dtime IS NULL ORDER BY ctime DESC;


-----------------------------------------

- create tables ANS_SENSE_CASE TEST GRID SENSE_SETSELECTED_SENSE( id ,ssenseid , timestamp , deleted timestamp(0),previous_sense ) ANS_SENSE_CASES( sensecaseid , stime , etime , senseid , testid , sense_trap1, sense_trap2 , senseans(senseid,st_1,st_2) ) TESTS(test id , grid snapshot id , timestamp start, timestamp end , up , down, percent)GRIDS(id , grid snapshot id,  selected/noselected, amount, y_lvl, x_serie, sensecases_set )GRID_SENSE_CASE_SETS(id grid_sense_set , sensecase_id )SUBJECTS( subject_key, subject_id , ssenseid )